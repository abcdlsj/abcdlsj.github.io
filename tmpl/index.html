{{define "index"}}
<!DOCTYPE html>
<html lang="en">
  <head>
    {{template "head" dict "Site" .Site "IsPost" false}}
  </head>
  <body>
    <div class="app">
      {{template "navbar" .}}
      <main class="surface home-shell">
        <section class="hero-blurb">
          {{.Site.Homepage}}
        </section>

        <section class="section-block">
          <div class="section-header section-header--with-search">
            <div>
              <h1 class="section-title">Recent Updates</h1>
              <a href="/posts" class="section-link">View All</a>
            </div>
            <div class="search-inline">
              <label for="search-input">Search Posts</label>
              <input
                type="text"
                id="search-input"
                placeholder="Enter keywords to filter in real-time"
                autocomplete="off"
              />
              <ul id="search-results" class="search-results"></ul>
            </div>
          </div>
          <div class="article-list">
            {{range .Posts}}
            <article class="post-card">
              <div class="post-card__meta">
                <time datetime="{{.Meta.Date}}">{{.Meta.Date | day}}</time>
                <span class="language-pill">
                  {{if contains .Meta.Languages "cn"}}CN{{else}}EN{{end}}
                </span>
              </div>
              <h2 class="post-card__title">
                <a href="/posts/{{.Uname | urlize}}.html">{{.Meta.Title}}</a>
              </h2>
              {{if .Meta.Description}}
              <p class="post-card__excerpt">{{.Meta.Description}}</p>
              {{end}}
              {{if .Meta.Tags}}
              <div class="post-card__tags">
                {{range $tag := .Meta.Tags}}
                <a href="/tags/{{$tag | urlize}}.html" class="tag-chip">#{{$tag}}</a>
                {{end}}
              </div>
              {{end}}
            </article>
            {{end}}
          </div>
        </section>

        {{if .WipPosts}}
        <section class="section-block">
          <div class="section-header">
            <h2 class="section-title">In Progress</h2>
            <p class="section-hint">These articles are still being polished. Subscribe to RSS for updates.</p>
          </div>
          <ul class="draft-list">
            {{range .WipPosts}}
            <li>
              <a href="/posts/{{.Uname | urlize}}.html" class="draft-pill">Â· {{.Meta.Title}}</a>
            </li>
            {{end}}
          </ul>
        </section>
        {{end}}
      </main>
      {{template "footer" .}}
    </div>
    <button class="back-to-top" type="button" onclick="scrollToTop()">Back to top</button>
    <script>
      function scrollToTop() {
        window.scrollTo({ top: 0, behavior: "smooth" });
      }
      const backToTop = document.querySelector(".back-to-top");
      const toggleButton = () => {
        if (!backToTop) return;
        backToTop.classList.toggle("back-to-top--visible", window.scrollY > 400);
      };
      window.addEventListener("scroll", toggleButton);
    </script>
  </body>
</html>
{{end}}